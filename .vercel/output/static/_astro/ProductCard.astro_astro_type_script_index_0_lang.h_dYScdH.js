import{f as g}from"./cartStore.CCaFZ5TA.js";import{i as l,r as h,a as x}from"./wishlistStore.DdiVJu_S.js";import{a as A}from"./recommendationsStore.vBwpm_-S.js";import{p as y,v as u,a as E}from"./client.schema.D9gTZs88.js";import"./index.9eZ28vGx.js";document.addEventListener("DOMContentLoaded",()=>{function a(r,e="success",t=3e3){document.querySelectorAll(".product-card").forEach(i=>{const o=i.querySelector(".product-notification");o&&(e==="success"?o.className="product-notification fixed top-4 right-4 p-4 rounded-lg shadow-lg max-w-md z-50 bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-100":o.className="product-notification fixed top-4 right-4 p-4 rounded-lg shadow-lg max-w-md z-50 bg-red-100 text-red-800 dark:bg-red-800 dark:text-red-100",o.textContent=r,o.classList.remove("hidden"),setTimeout(()=>{o.classList.add("hidden")},t))})}function s(r){if(!r)return null;try{const e=r.getAttribute("data-product-id"),t=r.getAttribute("data-product-name"),c=r.querySelector("img")?.getAttribute("src"),i=r.getAttribute("data-product-description"),o=r.getAttribute("data-product-price"),n=r.getAttribute("data-product-discount-price"),p=r.getAttribute("data-product-category");if(!e||!t||!c||!o)throw new Error("Datos de producto incompletos");const f=u(o),m=u(n||"0");return E({id:e,name:t,price:f,image:c,description:i||"",category:p||"",discountprice:m})}catch(e){return console.error("Error al extraer datos del producto:",e),a(e.message||"Error al procesar el producto","error"),null}}document.querySelectorAll(".add-to-cart-btn").forEach(r=>{r.addEventListener("click",e=>{try{const t=e.currentTarget,c=t.closest(".product-card"),i=s(c);if(!i)return;const o=y(i);g(o);const n=t.innerText;t.innerText="✓ Añadido",setTimeout(()=>{t.innerText=n},1500),a("Producto añadido al carrito con éxito")}catch(t){console.error("Error al añadir al carrito:",t),a(t.message||"No se pudo añadir el producto al carrito","error")}})}),document.querySelectorAll(".wishlist-btn").forEach(r=>{const e=r.getAttribute("data-product-id");e&&(d(r,l(e)),r.addEventListener("click",()=>{try{const t=r.closest(".product-card");if(!t||!e)return;if(l(e))h(e),d(r,!1),a("Producto eliminado de favoritos");else{const c=s(t);if(!c)return;x(c),d(r,!0),a("Producto añadido a favoritos")}}catch(t){console.error("Error con la lista de deseos:",t),a(t.message||"Error al procesar la lista de deseos","error")}}))});function d(r,e){const t=r.querySelector(".wishlist-icon");t&&(e?(t.classList.add("text-red-500"),t.setAttribute("fill","currentColor")):(t.classList.remove("text-red-500"),t.setAttribute("fill","none")))}document.querySelectorAll(".product-card").forEach(r=>{try{const e=s(r);e&&A(e)}catch(e){console.error("Error al registrar producto visto:",e)}})});

import{t as u,s as d}from"./supabase.CIJy6KaJ.js";function n(a,c,r,e=null){if(!a)return;a.classList.remove("hidden","bg-green-100","bg-red-100","bg-amber-100"),a.classList.add(c?"bg-green-100":"bg-red-100");let s=`<p class="font-medium ${c?"text-green-700":"text-red-700"}">${r}</p>`;if(e)if(typeof e=="object")try{if("session"in e&&e.session){const o=e.session,t=o.expires_at?new Date(o.expires_at*1e3).toLocaleString():"Desconocido";s+=`
              <div class="mt-2 text-sm">
                <p><span class="font-medium">Usuario:</span> ${o.user?.email||"Desconocido"}</p>
                <p><span class="font-medium">Expira:</span> ${t}</p>
              </div>
            `}else"count"in e?s+=`
              <div class="mt-2 text-sm">
                <p><span class="font-medium">Especies encontradas:</span> ${e.count||0}</p>
              </div>
            `:s+=`<pre class="mt-2 p-2 bg-gray-100 dark:bg-gray-800 rounded-md text-xs overflow-auto max-h-40">${JSON.stringify(e,null,2)}</pre>`}catch{s+='<p class="mt-2 text-sm text-gray-600 dark:text-gray-400">No se pudo mostrar detalles adicionales.</p>'}else s+=`<p class="mt-2 text-sm text-gray-600 dark:text-gray-400">${e}</p>`;a.innerHTML=s}document.addEventListener("DOMContentLoaded",()=>{const a=document.getElementById("test-connection"),c=document.getElementById("connection-result");a&&c&&a.addEventListener("click",async()=>{a.textContent="Probando...",a.disabled=!0;try{const t=await u();t.success?n(c,!0,"✅ Conexión exitosa con Supabase",t.data):n(c,!1,"❌ No se pudo conectar con Supabase",t.error)}catch(t){n(c,!1,"❌ Error al probar la conexión",t)}finally{a.textContent="Probar conexión",a.disabled=!1}});const r=document.getElementById("test-auth"),e=document.getElementById("auth-result");r&&e&&r.addEventListener("click",async()=>{r.textContent="Verificando...",r.disabled=!0;try{const{data:t,error:i}=await d.auth.getSession();i?n(e,!1,"❌ Error al verificar la sesión",i):t.session?n(e,!0,"✅ Sesión de autenticación válida",t):n(e,!1,"⚠️ No hay sesión de autenticación activa","Deberías iniciar sesión para acceder a funcionalidades protegidas.")}catch(t){n(e,!1,"❌ Error grave al verificar la autenticación",t)}finally{r.textContent="Verificar autenticación",r.disabled=!1}});const s=document.getElementById("test-db"),o=document.getElementById("db-result");s&&o&&s.addEventListener("click",async()=>{s.textContent="Probando...",s.disabled=!0;try{const{data:t,error:i,count:l}=await d.from("especies").select("*",{count:"exact"}).limit(1);i?n(o,!1,"❌ Error al acceder a la base de datos",i):n(o,!0,"✅ Acceso exitoso a la base de datos",{count:l})}catch(t){n(o,!1,"❌ Error grave al acceder a la base de datos",t)}finally{s.textContent="Probar acceso a datos",s.disabled=!1}})});

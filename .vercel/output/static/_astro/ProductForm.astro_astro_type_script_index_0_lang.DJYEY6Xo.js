import{s as E}from"./productStore.D1hgBiLb.js";import"./index.Bj88MMzq.js";import"./equality.Dp7T0ObN.js";import"./supabase.CIJy6KaJ.js";import"./client.schema.D9gTZs88.js";function p(o,n="success"){const r=document.getElementById("notifications");if(!r)return;const t=document.createElement("div");t.className=`p-4 rounded-md shadow-lg transform transition-all duration-500 ease-in-out ${n==="success"?"bg-green-100 text-green-800 border-l-4 border-green-500":"bg-red-100 text-red-800 border-l-4 border-red-500"}`,t.textContent=o,r.appendChild(t),setTimeout(()=>{t.classList.add("opacity-0","translate-x-full"),setTimeout(()=>{t.remove()},500)},5e3)}let u=!1;document.addEventListener("DOMContentLoaded",()=>{const o=document.getElementById("product-form"),n=document.getElementById("submit-button"),r=document.getElementById("submit-text"),t=document.getElementById("submit-spinner"),d=document.getElementById("error-message"),g=document.getElementById("error-text"),f=document.getElementById("especieid");f&&f.addEventListener("change",function(){const s=this.value;console.log("Especie seleccionada:",s),(!s||s.trim()==="")&&(this.value="")}),o&&o.addEventListener("submit",async s=>{if(s.preventDefault(),!u){u=!0,n&&(n.disabled=!0),r&&r.classList.add("hidden"),t&&t.classList.remove("hidden"),d&&d.classList.add("hidden"),document.querySelectorAll(".error-field").forEach(i=>{i.classList.add("hidden")});try{const i=o.querySelector("#name")?.value,c=o.querySelector("#price")?.value,S=o.querySelector("#image")?.value,y=o.querySelector("#description")?.value;if(!i||!c||!S||!y)throw new Error("Por favor complete todos los campos obligatorios");const e=new FormData(o),a={id:e.get("id")?.toString()||crypto.randomUUID(),name:e.get("name")?.toString()||"",price:parseInt(e.get("price")?.toString()||"0",10),discountprice:parseInt(e.get("discountprice")?.toString()||"0",10),image:e.get("image")?.toString()||"",description:e.get("description")?.toString()||"",category:e.get("category")?.toString()||"",stock:parseInt(e.get("stock")?.toString()||"0",10),isnew:e.get("isnew")==="on",featured:e.get("featured")==="on",rating:parseFloat(e.get("rating")?.toString()||"0"),features:(e.get("features")?.toString()||"").split(`
`).filter(m=>m.trim()!==""),ingredients:(e.get("ingredients")?.toString()||"").split(`
`).filter(m=>m.trim()!=="")},l=e.get("especieid")?.toString()||"";l&&l.trim()!==""&&(a.especieid=l),console.log("Producto a guardar:",a),await E(a),p("Producto guardado correctamente","success"),setTimeout(()=>{window.location.href="/admin/productos"},1e3)}catch(i){d&&d.classList.remove("hidden");let c="Error desconocido";i instanceof Error&&(c=i.message),g&&(g.textContent=`Error: ${c}`),p(c,"error"),console.error("Error completo:",i)}finally{n&&(n.disabled=!1),r&&r.classList.remove("hidden"),t&&t.classList.add("hidden"),u=!1}}})});

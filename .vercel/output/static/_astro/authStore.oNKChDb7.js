import{w as e}from"./index.Bj88MMzq.js";import{s}from"./supabase.CIJy6KaJ.js";const a=e(!1),o=e(null),i=e(!0),l=e(null);async function d(){try{i.set(!0),console.log("initAuth: Verificando sesión con Supabase...");const{data:t}=await s.auth.getSession();t.session?console.log("initAuth: Sesión activa encontrada"):console.log("initAuth: No hay sesión activa"),u(t.session);const{data:{subscription:r}}=s.auth.onAuthStateChange((c,n)=>{console.log("Auth state changed:",c,n?"Con sesión":"Sin sesión"),u(n)});return typeof window<"u"&&window.addEventListener("beforeunload",()=>{r.unsubscribe()}),{success:!0}}catch(t){return console.error("Error al inicializar autenticación:",t),l.set(t.message),{success:!1,error:t}}finally{i.set(!1)}}function u(t){console.log("Actualizando stores de auth:",t?"Autenticado":"No autenticado"),t?(a.set(!0),o.set(t.user),typeof window<"u"&&localStorage.setItem("authStatus","authenticated")):(a.set(!1),o.set(null),typeof window<"u"&&localStorage.removeItem("authStatus"))}typeof window<"u"&&d();export{a as i};

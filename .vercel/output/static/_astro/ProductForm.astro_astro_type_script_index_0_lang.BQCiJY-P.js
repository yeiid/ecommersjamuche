import{s as y}from"./productStore.C_VWqYAd.js";import"./index.Bj88MMzq.js";import"./equality.Dp7T0ObN.js";import"./supabase.CIJy6KaJ.js";import"./client.schema.D9gTZs88.js";function l(r,i="success"){const o=document.getElementById("notifications");if(!o)return;const t=document.createElement("div");t.className=`p-4 rounded-md shadow-lg transform transition-all duration-500 ease-in-out ${i==="success"?"bg-green-100 text-green-800 border-l-4 border-green-500":"bg-red-100 text-red-800 border-l-4 border-red-500"}`,t.textContent=r,o.appendChild(t),setTimeout(()=>{t.classList.add("opacity-0","translate-x-full"),setTimeout(()=>{t.remove()},500)},5e3)}let c=!1;document.addEventListener("DOMContentLoaded",()=>{const r=document.getElementById("product-form"),i=document.getElementById("submit-button"),o=document.getElementById("submit-text"),t=document.getElementById("submit-spinner"),d=document.getElementById("error-message"),m=document.getElementById("error-text");r&&r.addEventListener("submit",async g=>{if(g.preventDefault(),!c){c=!0,i&&(i.disabled=!0),o&&o.classList.add("hidden"),t&&t.classList.remove("hidden"),d&&d.classList.add("hidden"),document.querySelectorAll(".error-field").forEach(n=>{n.classList.add("hidden")});try{const n=r.querySelector("#name")?.value,s=r.querySelector("#price")?.value,u=r.querySelector("#image")?.value,f=r.querySelector("#description")?.value;if(!n||!s||!u||!f)throw new Error("Por favor complete todos los campos obligatorios");const e=new FormData(r),p={id:e.get("id")?.toString()||crypto.randomUUID(),name:e.get("name")?.toString()||"",price:parseInt(e.get("price")?.toString()||"0",10),discountprice:parseInt(e.get("discountprice")?.toString()||"0",10),image:e.get("image")?.toString()||"",description:e.get("description")?.toString()||"",category:e.get("category")?.toString()||"",stock:parseInt(e.get("stock")?.toString()||"0",10),isnew:e.get("isnew")==="on",rating:parseFloat(e.get("rating")?.toString()||"0"),especieid:e.get("especieid")?.toString()||"",features:(e.get("features")?.toString()||"").split(`
`).filter(a=>a.trim()!==""),ingredients:(e.get("ingredients")?.toString()||"").split(`
`).filter(a=>a.trim()!=="")};await y(p),l("Producto guardado correctamente","success"),setTimeout(()=>{window.location.href="/admin/productos"},1e3)}catch(n){d&&d.classList.remove("hidden");let s="Error desconocido";n instanceof Error&&(s=n.message),m&&(m.textContent=`Error: ${s}`),l(s,"error")}finally{i&&(i.disabled=!1),o&&o.classList.remove("hidden"),t&&t.classList.add("hidden"),c=!1}}})});
